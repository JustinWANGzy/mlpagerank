clear
load('three4-did-not-converge-found','T1');

% T1(:,:,1,1) = [
%          0     0     1
%          0     0     0
%          1     1     1
% ];
% 
% T1(:,:,2,1) = [
%          1     0     1
%          0     0     1
%          1     1     0
% ];
% 
% T1(:,:,3,1) = [
%          0     0     1
%          1     1     0
%          0     0     1
% ];

[~,hist,flag] = tpr4_power(normout(reshape(T1,3,27)')', ...
                    0.99, [1/3;1/3;1/3], 'maxiter', 1e5);
fprintf('niter = %i\n', length(hist));

% T1(:,:,1,1) =
%      0     0     0
%      0     0     0
%      0     0     0
% T1(:,:,2,1) =
%      0     0     0
%      0     0     0
%      0     0     0
% T1(:,:,3,1) =
%      0     0     0
%      0     0     0
%      0     0     0
% T1(:,:,1,2) =
%      0     0     0
%      0     0     0
%      0     0     0
% T1(:,:,2,2) =
%      0     0     0
%      0     0     0
%      0     0     0
% T1(:,:,3,2) =
%      0     0     0
%      0     0     0
%      0     0     0
% T1(:,:,1,3) =
%      0     1     0
%      1     0     0
%      0     0     1
% T1(:,:,2,3) =
%      1     1     0
%      1     1     0
%      0     0     1
% T1(:,:,3,3) =
%      0     0     0
%      1     0     0
%      1     1     1