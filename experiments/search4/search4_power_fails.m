f = @(T) ~get_outputs(@() tpr4_power(normout(reshape(T,2,8)')', ...
            0.99, [1/2;1/2]), 3); % get the flag output
search_tensors([2,2,2,2],f,'two4-did-not-converge', ...
    'filter',@(T) all(sum(reshape(T,2,8)) > 0));

%%
f = @(T) ~get_outputs(@() tpr4_power(normout(reshape(T,3,27)')', ...
            0.99, [1/3;1/3;1/3]), 3); % get the flag output
search_tensors([3,3,3,3],f,'three4-did-not-converge', ...
    'filter',@(T) all(sum(reshape(T,3,27)) > 0),'reverse',true,'useperm',true);

%%
f = @(T) ~get_outputs(@() tensorpr3(normout(reshape(T,2,4)')',...
                0.99).power,3); % get the flag output
    search_tensors([2,2,2],f,'two3-did-not-converge', ...
        'filter',@(T) all(sum(reshape(T,2,4)) > 0));